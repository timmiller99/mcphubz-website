"use strict";(()=>{var e={};e.id=222,e.ids=[222],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},82361:e=>{e.exports=require("events")},41808:e=>{e.exports=require("net")},71576:e=>{e.exports=require("string_decoder")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},56962:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>y,requestAsyncStorage:()=>h,routeModule:()=>d,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var a={};t.r(a),t.d(a,{GET:()=>u,POST:()=>p});var o=t(49303),s=t(88716),n=t(60670),i=t(87070),c=t(75748),l=t(79534);async function u(e){try{let r=e.nextUrl.searchParams,t=r.get("category"),a=r.get("search"),o=r.get("sort")||"qualityScore",s=parseInt(r.get("limit")||"50"),n=parseInt(r.get("offset")||"0"),u=`servers:${t}:${a}:${o}:${s}:${n}`,p=await l.Fs.get(u);if(p)return i.NextResponse.json(p);let d={status:"ACTIVE"};t&&"all"!==t&&(d.category=t),a&&(d.OR=[{name:{contains:a,mode:"insensitive"}},{description:{contains:a,mode:"insensitive"}}]);let[h,m]=await Promise.all([c.prisma.mcpServer.findMany({where:d,orderBy:{[o]:"desc"},take:s,skip:n,select:{id:!0,name:!0,description:!0,category:!0,qualityScore:!0,stars:!0,compatibility:!0,features:!0,githubUrl:!0,author:!0,lastUpdated:!0}}),c.prisma.mcpServer.count({where:d})]),g={servers:h,total:m,limit:s,offset:n,hasMore:n+s<m};return await l.Fs.set(u,g,3600),i.NextResponse.json(g)}catch(r){console.error("API Error:",r);let e=Array.from({length:20},(e,r)=>({id:`mock-${r+1}`,name:`MCP Server ${r+1}`,description:"A powerful MCP server for various integrations and automations.",category:["tools","api","data","automation"][Math.floor(4*Math.random())],qualityScore:Math.floor(40*Math.random())+60,stars:Math.floor(2e3*Math.random()),compatibility:{claude:Math.random()>.3,openai:Math.random()>.4,langchain:Math.random()>.5},features:["Fast","Reliable","Scalable","Easy to use"],githubUrl:`https://github.com/example/mcp-server-${r+1}`,author:`author-${r+1}`,lastUpdated:new Date().toISOString()}));return i.NextResponse.json({servers:e,total:e.length,limit:50,offset:0,hasMore:!1,mock:!0})}}async function p(e){try{let r=await e.json();if(e.headers.get("authorization")!==`Bearer ${process.env.ADMIN_API_KEY}`)return i.NextResponse.json({error:"Unauthorized"},{status:401});let t=await c.prisma.mcpServer.upsert({where:{githubUrl:r.githubUrl},create:r,update:r});return await l.Fs.flush(),i.NextResponse.json(t)}catch(e){return console.error("API Error:",e),i.NextResponse.json({error:"Internal Server Error"},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/servers/route",pathname:"/api/servers",filename:"route",bundlePath:"app/api/servers/route"},resolvedPagePath:"/home/user/webapp/src/app/api/servers/route.ts",nextConfigOutput:"export",userland:a}),{requestAsyncStorage:h,staticGenerationAsyncStorage:m,serverHooks:g}=d,v="/api/servers/route";function y(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},75748:(e,r,t)=>{t.d(r,{prisma:()=>o});var a=t(53524);let o=global.prisma||new a.PrismaClient({log:["error"]})},79534:(e,r,t)=>{t.d(r,{Fs:()=>n});var a=t(79984);let o=process.env.REDIS_URL||"redis://localhost:6379",s=(0,a.createClient)({url:o});s.on("error",e=>{console.error("Redis Client Error:",e)}),s.on("connect",()=>{console.log("Connected to Redis")}),s.connect().catch(console.error);let n={async get(e){try{s.isOpen||await s.connect();let r=await s.get(e);return r?JSON.parse(r):null}catch(e){return console.error("Cache get error:",e),null}},async set(e,r,t=3600){try{s.isOpen||await s.connect(),await s.setEx(e,t,JSON.stringify(r))}catch(e){console.error("Cache set error:",e)}},async del(e){try{s.isOpen||await s.connect(),await s.del(e)}catch(e){console.error("Cache delete error:",e)}},async flush(){try{s.isOpen||await s.connect(),await s.flushAll()}catch(e){console.error("Cache flush error:",e)}}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,680],()=>t(56962));module.exports=a})();